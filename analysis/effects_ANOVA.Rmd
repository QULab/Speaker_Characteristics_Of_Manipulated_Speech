---
title: "Effects of speech manipulations on warmth (ANOVA)"
author: "Laura Fernández Gallardo"
date: "April 2018"
output: 
  github_document:
    toc: true
    toc_depth: 3
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = './')
knitr::opts_chunk$set(fig.width=10, fig.height=5, dpi=150)
```


```{r echo=FALSE}

# clear
rm(list=ls())

```

```{r message=FALSE, warning=FALSE}

# Libraries needed:

library(ggplot2) # for plots
library(ez) # for ezANOVA


``` 


## Objectives

To assess the effects of manipulated speech (pitch, pitch range and formant shifts) on speakers' attributed warmth.

Load all stimuli dataframe and listeners' answers from test.

```{r echo=FALSE} 

# setting paths and loading data
setwd("D:/Users/fernandez.laura/Documents/Work/Projects_Github/Speaker_Characteristics_Of_Manipulated_Speech/analysis")

all_stimuli <- read.csv(paste0("../listening_test/all_stimuli.csv"))

```


Load output generated by GUI (listeners' answers)

```{r}

path_testoutput <- "../listening_test/GUI/files/output" 

answers <- data.frame()
file.names <- dir(path_testoutput, pattern =".csv") 
for(i in 1:length(file.names)){
  dataread <- read.csv(paste0(path_testoutput,'/',file.names[i]), header=TRUE, sep=",") 
  answers <- rbind(answers,dataread)
}

```


Merge answers and all_stimuli (information of conditions)

```{r}

mydata <- merge(all_stimuli, answers)
summary(mydata)

## listeners
#mean(mydata$ageListener)
#sd(mydata$ageListener)
#
#unique(mydata$languageListener)

```

7 listeners (5m, 5f) of different mother tongues. 
5 conditions and 8 speakers: 40 speech stimuli.


## 3-way repeated measures ANOVA

3-way repeated measures ANOVA to test the effects of 

* speech manipulation condition
* speaker gender 
* speaker "true" warmth (original_WAAT)
* interactions

3-way -> because we test the effect of 3 independent variable (with 2 or more levels each)

repeated measures -> because the same test participants rate the same dependent variable (speakers' warmth) for different conditions (speech manipulations)

We use the package ez to compute ezANOVA: Bakeman, R. (2005). Recommended effect size statistics for repeated measures designs. Behavior Research Methods, 37 (3), 379-384. 


```{r}

ezANOVA(data=mydata,
        dv='herzlich',
        wid=nameListener,
        within=.(condition, original_WAAT, speaker_gender),
        type = 2)


```

There is a significant effect of 'condition' on 'herzlich' (p<0.01), that is, the manipulation of speech affects the perceived warmth from speakers. No effect has been found for speaker gender or for speakers' original warmth (positive or negative).


## Boxplots across conditions

Plot "herzlich" (subjective impresions of speaker's warmth, dependent variable) vs. manipulation conditions, for speakers originally (clean non-manipulated speech) rated with positive and negative warmth-attractiveness (WAAT).


```{r}

ggplot(aes(y = herzlich, x = condition, fill = original_WAAT), data = mydata) +
  geom_boxplot() + 
  theme_bw()

```


We can observe that:

* For all conditions, low-WAAT speakers are always rated with lower median warmth than high-WAAT speakers. Only when F0 range is manipulated, high- and low-WAAT speakers tend to be rated with a similar level of warmth. The increase of F0 range results in low-WAAT speakers perceived as warmer. In contrast, the decrease of F0 range does not affect the perceptions of warmth of high-WAAT speakers.

* Manipulations of F0 mean causes the strongest difference between median warmth of low-WAAT and high-WAAT speakers: if F0 mean is decreased for low-WAAT speakers, they are perceived with even lower warmth. No strong difference can be seen with respect to natural speech when the F0 mean of high-WAAT speakers is increased. 

* Manipulations of F0 mean and F0 range (combined) makes almost no different with respect to ratings to original speech.

* Manipulations of F0 mean and formant shift: increasing the mean F0 and forman frequencies of high-WAAT speakers and lowering the mean F0 and forman frequencies of low-WAAT speakers leads to a more negative perception of their warmth.




